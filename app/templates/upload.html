{% extends "root.html" %}

{% set title = {'report': "Загрузка отчётов", 'pres': "Загрузка презентаций"}[file_type] %}
{% set upload_title = {'report': "Загрузите отчёт", 'pres': "Загрузите презентацию"}[file_type] %}

{% block title %}{{ title }}{% endblock %}

{% block main %}
    <div class="header row">{% include "header.html" %}</div>
    <div class="holder row justify-content-center">
    <script>
      const file_upload_limit = {{ config.MAX_CONTENT_LENGTH | tojson }};
      const file_type = "{{file_type}}";
      const optional = {{optional}};
      console.log(optional);
    </script>
        <div class="col-11 col-sm-8 col-md-5 col-lg-4 my-auto">
            <h3 class="text-center ins" id="upload_title">{{upload_title}}</h3>

            <div class="row justify-content-center" id="uploading_body">
                <div class="col my-auto">
                    <form>
                        <h6 class="text-center ins" id="upload_title">Прикрепите файл презентации в формате {{', '.join(formats)}}</h6>
                        <h5 class="texteous ins" id="uploading_label">{{uploading_label}}</h5>
                        <div class="form-group">
                            <div id="uploading_form" class="custom-file">
                                <input type="file" class="custom-file-input" id="upload_file" accept=".{{', .'.join(formats)}}">
                                <label class="custom-file-label" id="upload_file_label" for="upload_file">Допустимые форматы: {{ ", ".join(formats) }}</label>
                                <div class="invalid-feedback ins">Возникла ошибка</div>
                            </div>
                        </div>
                        {% if "fullname" in optional %}
                            <div>
                                {% if optional.split('fullname:')[1][0] == '1' %}
                                    <h6 class="text-center ins" id="upload_title">Введите своё ФИО</h6>
                                {% else %}
                                    <h6 class="text-center ins" id="upload_title">Введите своё ФИО (Не обязательно)</h6>
                                {% endif %}
                                <div class="form-group">
                                    <div id="uploading_form_fullname" class="custom-text">
                                        <input type="text" class="custom-text-input" id="upload_fullname" placeholder="Юрьев Юрий Юрьевич">
                                        <div class="invalid-feedback ins">Возникла ошибка</div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                        {% if "group" in optional %}
                            <div>
                                {% if optional.split('group:')[1][0] == '1' %}
                                    <h6 class="text-center ins" id="upload_title">Введите номер своей группы</h6>
                                {% else %}
                                    <h6 class="text-center ins" id="upload_title">Введите номер своей группы (Не обязательно)</h6>
                                {% endif %}
                                <div class="form-group">
                                    <div id="uploading_form_group" class="custom-text">
                                        <input type="text" class="custom-text-input" id="upload_group" placeholder="9301">
                                        <div class="invalid-feedback ins">Возникла ошибка</div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                        {% if "comments" in optional %}
                            <div>
                                {% if optional.split('comments:')[1][0] == '1' %}
                                    <h6 class="text-center ins" id="upload_title">Оставьте комментарий</h6>
                                {% else %}
                                    <h6 class="text-center ins" id="upload_title">Оставьте комментарий (Не обязательно)</h6>
                                {% endif %}
                                <div class="form-group">
                                    <div id="uploading_form_comments" class="custom-text">
                                        <input type="text" class="custom-text-input" id="upload_comments" placeholder="Ваши комментарии к работе">
                                        <div class="invalid-feedback ins">Возникла ошибка</div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                        <div id="uploading_progress_holder" class="form-group" style="display: none">
                            <div class="progress">
                                <div id="uploading_progress" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100" style="width: 10%"></div>
                            </div>
                        </div>
                        {% if not current_user.is_LTI %}
                            {{ recaptcha }}
                        {% endif %}
                    </form>
                        <button type="button" class="pale_button" id="upload_upload_button">Загрузить</button>
                </div>
            </div>

            <div class="row justify-content-center" id="uploading_body">
                <div class="col my-auto">
                    <form>
                        <div class="form-group" style="display: none">
                            <div id="uploading_progress" class="progress">
                                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100" style="width: 10%"></div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

        </div>
    </div>
{% endblock %}
